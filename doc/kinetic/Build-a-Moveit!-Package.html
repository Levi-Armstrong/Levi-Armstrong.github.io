

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Motivation &mdash; SphinxTest 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="SphinxTest 1.0 documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> SphinxTest
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="ROS-Setup.html">1. Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS-Setup.html#reference-example">2. Reference Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS-Setup.html#further-information-and-resources">3. Further Information and Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS-Setup.html#scan-n-plan-application-problem-statement">4. Scan-N-Plan Application: Problem Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROS-Setup.html#scan-n-plan-application-guidance">5. Scan-N-Plan Application: Guidance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-Catkin-Workspace.html">1. Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-Catkin-Workspace.html#reference-example">2. Reference Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-Catkin-Workspace.html#further-information-and-resources">3. Further Information and Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-Catkin-Workspace.html#scan-n-plan-application-problem-statement">4. Scan-N-Plan Application: Problem Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-Catkin-Workspace.html#scan-n-plan-application-guidance">5. Scan-N-Plan Application: Guidance</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">SphinxTest</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>1. Motivation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/doc/kinetic/Build-a-Moveit!-Package.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <blockquote>
<div>In this exercise, we will create a MoveIt! package for an industrial robot. This package creates the configuration and launch files required to use a robot with the MoveIt! Motion-Control nodes. In general, the MoveIt! package does not contain any C++ code.</div></blockquote>
<hr class="docutils" />
<div class="section" id="motivation">
<span id="motivation"></span><h1>1. Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h1>
<p>MoveIt! is a free-space motion planning framework for ROS. It’s an incredibly useful and easy-to-use tool for planning motions between two points in space without colliding with anything. Under the hood MoveIt is quite complicated, but unlike most ROS libraries, it has a really nice GUI Wizard to get you going.</p>
</div>
<div class="section" id="reference-example">
<span id="reference-example"></span><h1>2. Reference Example<a class="headerlink" href="#reference-example" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://wiki.ros.org/Industrial/Tutorials/Create_a_MoveIt_Pkg_for_an_Industrial_Robot">Using MoveIt with ROS-I</a></p>
</div>
<div class="section" id="further-information-and-resources">
<span id="further-information-and-resources"></span><h1>3. Further Information and Resources<a class="headerlink" href="#further-information-and-resources" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://docs.ros.org/kinetic/api/moveit_tutorials/html/doc/setup_assistant/setup_assistant_tutorial.html">MoveIt’s Standard Wizard Guide</a></p>
</div>
<div class="section" id="scan-n-plan-application-problem-statement">
<span id="scan-n-plan-application-problem-statement"></span><h1>4. Scan-N-Plan Application: Problem Statement<a class="headerlink" href="#scan-n-plan-application-problem-statement" title="Permalink to this headline">¶</a></h1>
<p>In this exercise, you will generate a MoveIt package for the UR5 workcell you built in a previous step. This process will mostly involve running the MoveIt! Setup Assistant. At the end of the exercise you should have the following:</p>
<ol class="simple">
<li>A new package called <code class="docutils literal"><span class="pre">myworkcell_moveit_config</span></code></li>
<li>A moveit configuration with one group (&quot;manipulator&quot;), that consists of the kinematic chain between the UR5’s <code class="docutils literal"><span class="pre">base_link</span></code> and <code class="docutils literal"><span class="pre">tool0</span></code>.</li>
<li>Fun playing with the motion planning tools.</li>
</ol>
</div>
<div class="section" id="scan-n-plan-application-guidance">
<span id="scan-n-plan-application-guidance"></span><h1>5. Scan-N-Plan Application: Guidance<a class="headerlink" href="#scan-n-plan-application-guidance" title="Permalink to this headline">¶</a></h1>
<ol>
<li><p class="first">Start the MoveIt! Setup Assistant (don't forget auto-complete with tab):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">moveit_setup_assistant</span> <span class="n">setup_assistant</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
</li>
<li><p class="first">Select &quot;Create New MoveIt Configuration Package&quot;, select the <code class="docutils literal"><span class="pre">workcell.xacro</span></code> you created previously, then &quot;Load File&quot;.</p>
</li>
<li><p class="first">Work your way through the tabs on the left from the top down.</p>
<ol>
<li><p class="first">Generate a self-(myworkcell_moveit_config/config/joint_names.yaml):collision matrix.</p>
</li>
<li><p class="first">Add a fixed virtual base joint. e.g.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FixedBase&#39;</span> <span class="p">(</span><span class="n">arbitrary</span><span class="p">)</span>
<span class="n">child</span> <span class="o">=</span> <span class="s1">&#39;world&#39;</span> <span class="p">(</span><span class="n">should</span> <span class="n">match</span> <span class="n">the</span> <span class="n">URDF</span> <span class="n">root</span> <span class="n">link</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="s1">&#39;world&#39;</span> <span class="p">(</span><span class="n">reference</span> <span class="n">frame</span> <span class="n">used</span> <span class="k">for</span> <span class="n">motion</span> <span class="n">planning</span><span class="p">)</span>
<span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;fixed&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Add a planning group called <code class="docutils literal"><span class="pre">manipulator</span></code> that names the kinematic chain between <code class="docutils literal"><span class="pre">base_link</span></code> and <code class="docutils literal"><span class="pre">tool0</span></code>.</p>
<p>a. Set the kinematics solver to <code class="docutils literal"><span class="pre">KDLKinematicsPlugin</span></code></p>
</li>
<li><p class="first">Create a few named positions (e.g. &quot;home&quot;, &quot;allZeros&quot;, etc.) to test with motion-planning.</p>
</li>
<li><p class="first">Don't worry about adding end effectors/grippers or passive joints for this exercise.</p>
</li>
<li><p class="first">Enter author / maintainer info.</p>
<p><em>Yes, it's required, but doesn't have to be valid</em></p>
</li>
<li><p class="first">Create a package and name it <code class="docutils literal"><span class="pre">myworkcell_moveit_config</span></code>.</p>
</li>
</ol>
</li>
</ol>
<p>The outcome of these steps will be a new package that contains a large number of launch and configuration files. At this point, it's possible to do motion planning, but not to execute the plan on any robot.  To try out your new configuration:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>```
catkin build
source ~/catkin_ws/devel/setup.bash
roslaunch myworkcell_moveit_config demo.launch
```
</pre></div>
</div>
<blockquote>
<div>Don't worry about learning how to use RViz to move the robot; that's what we'll cover in the next session!</div></blockquote>
</div>
<div class="section" id="using-moveit-with-physical-hardware">
<span id="using-moveit-with-physical-hardware"></span><h1>6. Using MoveIt! with Physical Hardware<a class="headerlink" href="#using-moveit-with-physical-hardware" title="Permalink to this headline">¶</a></h1>
<p>MoveIt!'s setup assistant generates a suite of files that, upon launch:</p>
<ul class="simple">
<li>Loads your workspace description to the parameter server.</li>
<li>Starts a node <code class="docutils literal"><span class="pre">move_group</span></code> that offers a suite of ROS services &amp; actions for doing kinematics, motion planning, and more.</li>
<li>An internal simulator that publishes the last planned path on a loop for other tools (like RViz) to visualize.</li>
</ul>
<p>Essentially, MoveIt can publish a ROS message that defines a trajectory (joint positions over time), but it doesn't know how to pass that trajectory to your hardware.</p>
<p>To do this, we need to define a few extra files.</p>
<ol>
<li><p class="first">Create a <code class="docutils literal"><span class="pre">controllers.yaml</span></code> file (<code class="docutils literal"><span class="pre">myworkcell_moveit_config/config/controllers.yaml</span></code>) with the following contents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">controller_list</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="n">action_ns</span><span class="p">:</span> <span class="n">joint_trajectory_action</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">FollowJointTrajectory</span>
    <span class="n">joints</span><span class="p">:</span> <span class="p">[</span><span class="n">shoulder_pan_joint</span><span class="p">,</span> <span class="n">shoulder_lift_joint</span><span class="p">,</span> <span class="n">elbow_joint</span><span class="p">,</span> <span class="n">wrist_1_joint</span><span class="p">,</span> <span class="n">wrist_2_joint</span><span class="p">,</span> <span class="n">wrist_3_joint</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">joint_names.yaml</span></code> file (<code class="docutils literal"><span class="pre">myworkcell_moveit_config/config/joint_names.yaml</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">controller_joint_names</span><span class="p">:</span> <span class="p">[</span><span class="n">shoulder_pan_joint</span><span class="p">,</span> <span class="n">shoulder_lift_joint</span><span class="p">,</span> <span class="n">elbow_joint</span><span class="p">,</span> <span class="n">wrist_1_joint</span><span class="p">,</span> <span class="n">wrist_2_joint</span><span class="p">,</span> <span class="n">wrist_3_joint</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">Fill in the existing, but blank, controller_manager launch file (<code class="docutils literal"><span class="pre">myworkcell_moveit_config/launch/myworkcell_moveit_controller_manager.launch.xml</span></code>):</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;moveit_controller_manager&quot;</span>
       <span class="na">default=</span><span class="s">&quot;moveit_simple_controller_manager/MoveItSimpleControllerManager&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;moveit_controller_manager&quot;</span>
         <span class="na">value=</span><span class="s">&quot;$(arg moveit_controller_manager)&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;rosparam</span> <span class="na">file=</span><span class="s">&quot;$(find myworkcell_moveit_config)/config/controllers.yaml&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a new <code class="docutils literal"><span class="pre">myworkcell_planning_execution.launch</span></code> (in <code class="docutils literal"><span class="pre">myworkcell_moveit_config/launch</span></code>):</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
  <span class="c">&lt;!-- The planning and execution components of MoveIt! configured to run --&gt;</span>
  <span class="c">&lt;!-- using the ROS-Industrial interface. --&gt;</span>

  <span class="c">&lt;!-- Non-standard joint names:</span>
<span class="c">       - Create a file [robot_moveit_config]/config/joint_names.yaml</span>
<span class="c">           controller_joint_names: [joint_1, joint_2, ... joint_N]</span>
<span class="c">       - Update with joint names for your robot (in order expected by rbt controller)</span>
<span class="c">       - and uncomment the following line: --&gt;</span>
  <span class="nt">&lt;rosparam</span> <span class="na">command=</span><span class="s">&quot;load&quot;</span> <span class="na">file=</span><span class="s">&quot;$(find myworkcell_moveit_config)/config/joint_names.yaml&quot;</span><span class="nt">/&gt;</span>

  <span class="c">&lt;!-- the &quot;sim&quot; argument controls whether we connect to a Simulated or Real robot --&gt;</span>
  <span class="c">&lt;!--  - if sim=false, a robot_ip argument is required --&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;sim&quot;</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;robot_ip&quot;</span> <span class="na">unless=</span><span class="s">&quot;$(arg sim)&quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!-- load the robot_description parameter before launching ROS-I nodes --&gt;</span>
  <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find myworkcell_moveit_config)/launch/planning_context.launch&quot;</span> <span class="nt">&gt;</span>
   <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;load_robot_description&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/include&gt;</span>

  <span class="c">&lt;!-- run the robot simulator and action interface nodes --&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">if=</span><span class="s">&quot;$(arg sim)&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find industrial_robot_simulator)/launch/robot_interface_simulator.launch&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/group&gt;</span>

  <span class="c">&lt;!-- run the &quot;real robot&quot; interface nodes --&gt;</span>
  <span class="c">&lt;!--   - this typically includes: robot_state, motion_interface, and joint_trajectory_action nodes --&gt;</span>
  <span class="c">&lt;!--   - replace these calls with appropriate robot-specific calls or launch files --&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">unless=</span><span class="s">&quot;$(arg sim)&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find ur_bringup)/launch/ur5_bringup.launch&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/group&gt;</span>

  <span class="c">&lt;!-- publish the robot state (tf transforms) --&gt;</span>
  <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="na">pkg=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="na">type=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find myworkcell_moveit_config)/launch/move_group.launch&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;publish_monitored_planning_scene&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/include&gt;</span>

  <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find myworkcell_moveit_config)/launch/moveit_rviz.launch&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/include&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Now let's test the new launch files we created:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">myworkcell_moveit_config</span> <span class="n">myworkcell_planning_execution</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
</li>
</ol>
<p><center></p>
<p>| [[&lt; Prev|Coordinate-Transforms-using-TF]] | [[Next &gt;|Motion-Planning-RVIZ]] |
|:---  | ---:|</p>
<p></center></p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Levi Armstrong.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>